<!DOCTYPE html>
<html lang="en">

<head>
    <script>
        // for search plugin notably
        const base_url = "https://yashpotdar-py.github.io/rl-ids/";
    </script>
    <script>
        const darkTheme = window.matchMedia("(prefers-color-scheme: dark)");
        darkTheme.onchange = (e) => {
            if (e.matches) {
                document.documentElement.classList.add("dark")
                localStorage.theme = 'dark';
            } else {
                document.documentElement.classList.remove("dark")
                localStorage.removeItem("theme")
            }
        };

        // On page load. Priotiry to lcaolStorage
        if (localStorage.theme === "dark") {
            document.documentElement.classList.add("dark")
        } else if (localStorage.theme === "light") {
            document.documentElement.classList.remove("dark")
        } else if (darkTheme.matches) {
            document.documentElement.classList.add("dark")
        } else {
            document.documentElement.classList.remove("dark")
        }
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>RL Agents - RL-IDS Adaptive System</title>
    


<title>RL Agents</title>









<link rel="canonical" href="https://yashpotdar-py.github.io/rl-ids/modules/agents/">


<!-- Open Graph (Facebook, LinkedIn) -->

<meta property="og:title" content="RL Agents">





<meta property="og:url" content="https://yashpotdar-py.github.io/rl-ids/modules/agents/">






<!-- Twitter Card -->

<meta name="twitter:title" content="RL Agents">






<!-- JSON-LD Structured Data -->



    <link rel="icon" href="../../img/favicon.ico">
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/geist.css" rel="stylesheet">
    
    <link href="../../css/pygments/dracula.css" rel="stylesheet">
    

    <script src="../../js/callbacks.js"></script>

    

    

    

</head>

<body class="w-screen overflow-x-hidden bg-foreground md:bg-background text-foreground scroll-smooth m-0 p-0">
    <div id="inner-body"
        class="min-h-screen bg-background origin-[top_center_0px] transition-all duration-500 ease-[cubic-bezier(0.32,0.72,0,1)]">
        <header
    class="border-grid sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60">
    <div class="w-full mx-auto 3xl:max-w-8xl">
        <div
            class="xl:px-6 h-14 w-full max-w-8xl mx-auto px-4 border-x border-grid flex flex-row justify-between items-center">
            <div class="mr-4 hidden md:flex">
                <a href="/" class="mr-4 flex items-center gap-2 lg:mr-6">
                    
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"
    class="h-6 w-6">
    <rect width="256" height="256" fill="none"></rect>
    <line x1="208" y1="128" x2="128" y2="208" fill="none" stroke="currentColor" stroke-linecap="round"
        stroke-linejoin="round" stroke-width="32"></line>
    <line x1="192" y1="40" x2="40" y2="192" fill="none" stroke="currentColor" stroke-linecap="round"
        stroke-linejoin="round" stroke-width="32"></line>
</svg>

                    <h1 class="hidden lg:inline-block font-bold text-md">
                        
                        RL-IDS Adaptive System
                        
                    </h1>
                </a>
            </div>
            <button
                class="cursor-pointer inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:text-accent-foreground py-2 -ml-2 mr-2 h-8 w-8 px-0 text-base hover:bg-transparent focus-visible:bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 md:hidden"
                type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R15u6ja:"
                data-state="closed" onclick="onMobileMenuButtonClick(event)">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="!size-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5"></path>
                </svg>
                <span class="sr-only">Toggle Menu</span>
            </button>
            <div class="flex flex-1 items-center justify-between gap-2 md:justify-end">
                <button onclick="onSearchBarClick(event)"
    class="cursor-pointer inline-flex items-center gap-2 whitespace-nowrap transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 border border-input hover:bg-accent hover:text-accent-foreground px-4 py-2 relative h-8 w-full justify-start rounded-[0.5rem] bg-muted/50 text-sm font-normal text-muted-foreground shadow-none sm:pr-12 md:w-40 lg:w-56 xl:w-64">
    <span class="hidden lg:inline-flex">Search documentation...</span>
    <span class="inline-flex lg:hidden">Search...</span>
    <kbd
        class="pointer-events-none absolute right-[0.3rem] top-[0.3rem] hidden h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex">
        <span class="text-xs">âŒ˜</span>K
    </kbd>
</button>
<dialog id="search-dialog" onclick="onSearchDialogClick(event)"
    class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-background rounded-lg shadow-lg border overflow-hidden p-0">
    <div class="w-lg gap-4">
        <div class="flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground">
            <div class="w-full flex items-center border-b px-3" cmdk-input-wrapper="">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="mr-2 h-4 w-4 shrink-0 opacity-50">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.3-4.3"></path>
                </svg>
                <!-- <script>
                    let debounceTimer;
                    const onInputHandler = function (event) {
                        const query = event.target.value;
                        clearTimeout(debounceTimer);
                        debounceTimer = setTimeout(() => {
                            if (searchWorker && (query.length > 2)) {
                                console.log(`Posting message { "query": "${query}" }`)
                                // https://lunrjs.com/guides/searching.html
                                // we should append a wilcard and also a boost on exact term
                                const lunrQuery = `${query}^10 ${query}* ${query}~1`;
                                searchWorker.postMessage({ "query": lunrQuery });
                            } else if (query.length > 2) {
                                console.warn("searchWorker is not defined")
                            } else {
                                const results = document.getElementById("mkdocs-search-results");
                                if (results) {
                                    while (results.firstChild) {
                                        results.removeChild(results.firstChild);
                                    }
                                }
                            }
                        }, 300);
                    };
                </script> -->
                <input
                    class="flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50"
                    placeholder="Type a command or search..." autocomplete="off" autocorrect="off" spellcheck="false"
                    aria-autocomplete="list" role="combobox" aria-expanded="true" type="text" value=""
                    oninput="onInputHandler(event)">
            </div>
        </div>
        <div id="mkdocs-search-results" class="max-h-[300px] overflow-y-auto overflow-x-hidden">
            <!-- search results go there -->
        </div>
    </div>
</dialog>
<script>
    document.removeEventListener("keydown", searchShortcutHandler);
    document.addEventListener("keydown", searchShortcutHandler);
</script>
                <div class="flex items-center gap-0.5">
                    
                    <button
                        class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-8 w-8 px-0"><a
                            target="_blank" rel="noreferrer" href="https://github.com/yashpotdar-py/rl-ids">
                            
                            <svg viewBox="0 0 438.549 438.549" class="h-4 w-4">
    <path fill="currentColor"
        d="M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 01-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z">
    </path>
</svg>
                            <span class="sr-only">GitHub</span>
                            
                        </a>
                    </button>
                    
                    <button
                        class="cursor-pointer inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground py-2 group/toggle h-8 w-8 px-0"
                        onclick="onThemeSwitch(event)">
                        
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round"
    class="h-4 w-4 dark:hidden not-dark:block">
    <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />
</svg>
                        
                        
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round"
    class="h-4 w-4 not-dark:hidden dark:block">
    <circle cx="12" cy="12" r="4" />
    <path d="M12 2v2" />
    <path d="M12 20v2" />
    <path d="m4.93 4.93 1.41 1.41" />
    <path d="m17.66 17.66 1.41 1.41" />
    <path d="M2 12h2" />
    <path d="M20 12h2" />
    <path d="m6.34 17.66-1.41 1.41" />
    <path d="m19.07 4.93-1.41 1.41" />
</svg>
                        
                        <span class="sr-only">Toggle theme</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="border-grid flex flex-1 flex-col">
            <div class="w-full mx-auto 3xl:max-w-8xl">
                <div
                    class="px-4 w-full max-w-8xl mx-auto xl:px-6 flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10">
                    <aside
                        class="border-grid fixed top-14 z-30 hidden h-[calc(100vh-3.55rem)] w-full shrink-0 border-r md:sticky md:block">
                        <div
    class="no-scrollbar [&::-webkit-scrollbar]:hidden h-full overflow-auto py-6 pr-4 lg:py-8 flex flex-col gap-[.125rem]">
    
    
    

    
    
    <a href="../.." 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Home
    

    

    

    
</a>
    
    
    
    <a href="../../changelog/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Changelog
    

    

    

    
</a>
    
    
    
    <a href="../../faq/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    FAQ
    

    

    

    
</a>
    
    
    
    <a href="../../license/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    LICENSE
    

    

    

    
</a>
    
    


    
    
    <div class="flex flex-col gap-1 mt-5 first:mt-0">
        <h4 class="rounded-md px-2 py-1 text-sm font-semibold">User Guide</h4>
        <div class="grid grid-flow-row auto-rows-max gap-[.125rem]">
            
            <a href="../../user-guide/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Overview
    

    

    

    
</a>
            
            <a href="../../user-guide/installation/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Installation
    

    

    

    
</a>
            
            <a href="../../user-guide/network-monitoring/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Network Monitoring
    

    

    

    
</a>
            
            <a href="../../user-guide/website-monitoring/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Website Monitoring
    

    

    

    
</a>
            
        </div>
    </div>
    
    
    
    <div class="flex flex-col gap-1 mt-5 first:mt-0">
        <h4 class="rounded-md px-2 py-1 text-sm font-semibold">API Reference</h4>
        <div class="grid grid-flow-row auto-rows-max gap-[.125rem]">
            
            <a href="../../api/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Overview
    

    

    

    
</a>
            
            <a href="../../api/examples/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Examples
    

    

    

    
</a>
            
            <a href="../../api/python-client/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Python Client
    

    

    

    
</a>
            
        </div>
    </div>
    
    
    
    <div class="flex flex-col gap-1 mt-5 first:mt-0">
        <h4 class="rounded-md px-2 py-1 text-sm font-semibold">Modules</h4>
        <div class="grid grid-flow-row auto-rows-max gap-[.125rem]">
            
            <a href="../" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Core Components
    

    

    

    
</a>
            
            <a href="./" data-active 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    RL Agents
    

    

    

    
</a>
            
            <a href="../features/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Feature Extraction
    

    

    

    
</a>
            
        </div>
    </div>
    
    
    
    <div class="flex flex-col gap-1 mt-5 first:mt-0">
        <h4 class="rounded-md px-2 py-1 text-sm font-semibold">Development</h4>
        <div class="grid grid-flow-row auto-rows-max gap-[.125rem]">
            
            <a href="../../development/architecture/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Architecture
    

    

    

    
</a>
            
            <a href="../../development/contributing/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Contributing
    

    

    

    
</a>
            
            <a href="../../development/testing/" 
    class="text-sm flex shrink-0 h-8 w-full items-center rounded-lg px-2 text-foreground underline-offset-2 font-normal hover:bg-accent hover:text-accent-foreground data-active:bg-accent data-active:font-medium data-active:text-accent-foreground">
    
    Testing
    

    

    

    
</a>
            
        </div>
    </div>
    
    
    
</div>
                    </aside>
                    <main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
                        <div class="mx-auto w-full min-w-0 xl:max-w-2xl">
                            <article class="typography w-full">
    
    <div class="mb-4 flex items-center space-x-1 text-sm leading-none text-muted-foreground">
    


<span class="truncate">Modules</span>


<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5">
    <path d="m9 18 6-6-6-6"></path>
</svg>
<div class="text-foreground">RL Agents</div>

</div>
    
    
    
    <h1 id="rl-agents">RL Agents</h1>
<p>This document covers the reinforcement learning agents used in RL-IDS, specifically the Deep Q-Network (DQN) implementation.</p>
<h2 id="overview">Overview</h2>
<p>The RL-IDS system uses Deep Q-Network (DQN) agents for network intrusion detection. The implementation is located in <code>rl_ids/agents/dqn_agent.py</code> and provides a configurable, high-performance agent suitable for multi-class classification tasks.</p>
<h2 id="dqn-agent-architecture">DQN Agent Architecture</h2>
<h3 id="core-components">Core Components</h3>
<p>The DQN agent consists of several key components:</p>
<ol>
<li><strong>Deep Q-Network Model</strong> - Neural network for Q-value estimation</li>
<li><strong>Target Network</strong> - Stabilized target for Q-learning updates</li>
<li><strong>Replay Buffer</strong> - Experience replay for stable learning</li>
<li><strong>Epsilon-Greedy Policy</strong> - Exploration vs exploitation strategy</li>
</ol>
<h3 id="network-architecture">Network Architecture</h3>
<pre><code class="language-python">class DQN(nn.Module):
    &quot;&quot;&quot;Deep Q-Network model.&quot;&quot;&quot;

    def __init__(self, input_dim: int, output_dim: int, hidden_dims: List[int] = [256, 128]):
        super(DQN, self).__init__()

        layers = []
        prev_dim = input_dim

        for hidden_dim in hidden_dims:
            layers.extend([nn.Linear(prev_dim, hidden_dim), nn.ReLU()])
            prev_dim = hidden_dim

        layers.append(nn.Linear(prev_dim, output_dim))

        self.fc = nn.Sequential(*layers)

    def forward(self, x: torch.Tensor) -&gt; torch.Tensor:
        &quot;&quot;&quot;Forward pass through the network.&quot;&quot;&quot;
        return self.fc(x)
</code></pre>
<p><strong>Default Architecture:</strong>
- Input Layer: 78 features (CICIDS2017 feature set)
- Hidden Layers: Configurable (default: [1024, 512, 256, 128])
- Output Layer: 15 classes (attack types + benign)
- Activation: ReLU between layers
- Output: Raw Q-values (no activation)</p>
<h2 id="dqn-configuration">DQN Configuration</h2>
<h3 id="configuration-class">Configuration Class</h3>
<pre><code class="language-python">class DQNConfig(BaseModel):
    &quot;&quot;&quot;Configuration for DQN Agent.&quot;&quot;&quot;

    state_dim: int = Field(..., description=&quot;State space dimension&quot;)
    action_dim: int = Field(..., description=&quot;Action space dimension&quot;)
    lr: float = Field(1e-4, description=&quot;Learning rate&quot;)
    gamma: float = Field(0.99, description=&quot;Discount factor&quot;)
    epsilon: float = Field(1.0, description=&quot;Initial exploration rate&quot;)
    eps_decay: float = Field(0.995, description=&quot;Epsilon decay rate&quot;)
    eps_min: float = Field(0.1, description=&quot;Minimum epsilon value&quot;)
    memory_size: int = Field(3000000, description=&quot;Replay buffer size&quot;)
    batch_size: int = Field(64, description=&quot;Training batch size&quot;)
    hidden_dims: List[int] = Field([256, 128], description=&quot;Hidden layer dimensions&quot;)
</code></pre>
<h3 id="training-configuration">Training Configuration</h3>
<p>The training script (<code>rl_ids/modeling/train.py</code>) provides extensive configuration options:</p>
<pre><code class="language-python"># Core training parameters
num_episodes: int = 500              # Number of training episodes
target_update_interval: int = 10     # Target network update frequency
lr: float = 1e-4                     # Learning rate
gamma: float = 0.995                 # Discount factor

# Exploration parameters
epsilon: float = 1.0                 # Initial exploration rate
eps_decay: float = 0.9995           # Epsilon decay rate
eps_min: float = 0.01               # Minimum epsilon value

# Network architecture
hidden_dims: str = &quot;1024,512,256,128&quot;  # Hidden layer dimensions
dropout_rate: float = 0.2            # Dropout rate for regularization
use_layer_norm: bool = True          # Use layer normalization

# Training optimization
memory_size: int = 100000            # Replay buffer size
batch_size: int = 256                # Training batch size
warmup_steps: int = 1000             # Warmup steps before training

# Advanced features
curriculum_learning: bool = True     # Use curriculum learning
double_dqn: bool = True             # Use Double DQN
dueling: bool = True                # Use Dueling DQN architecture
prioritized_replay: bool = False    # Use prioritized experience replay
</code></pre>
<h2 id="dqn-agent-implementation">DQN Agent Implementation</h2>
<h3 id="agent-class">Agent Class</h3>
<pre><code class="language-python">class DQNAgent:
    &quot;&quot;&quot;Deep Q-Network Agent for reinforcement learning.&quot;&quot;&quot;

    def __init__(self, config: DQNConfig):
        &quot;&quot;&quot;Initialize DQN Agent with configuration.&quot;&quot;&quot;
        self.config = config
        self.state_dim = config.state_dim
        self.action_dim = config.action_dim
        self.gamma = config.gamma
        self.epsilon = config.epsilon
        self.eps_decay = config.eps_decay
        self.eps_min = config.eps_min
        self.batch_size = config.batch_size

        # Device selection
        self.device = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;)

        # Initialize networks
        self.model = DQN(config.state_dim, config.action_dim, config.hidden_dims).to(self.device)
        self.target_model = DQN(config.state_dim, config.action_dim, config.hidden_dims).to(self.device)
        self.update_target()

        # Training components
        self.criterion = nn.MSELoss()
        self.optimizer = optim.Adam(self.model.parameters(), lr=config.lr)
        self.memory = deque(maxlen=config.memory_size)

        # Training metrics
        self.training_step = 0
        self.episode_count = 0
</code></pre>
<h3 id="key-methods">Key Methods</h3>
<h4 id="action-selection">Action Selection</h4>
<pre><code class="language-python">def act(self, state: np.ndarray, training: bool = True) -&gt; int:
    &quot;&quot;&quot;Choose action using epsilon-greedy policy.&quot;&quot;&quot;
    if training and random.random() &lt; self.epsilon:
        action = random.randint(0, self.action_dim - 1)
        return action

    state_tensor = torch.FloatTensor(state).unsqueeze(0).to(self.device)
    with torch.no_grad():
        q_values = self.model(state_tensor)

    action = q_values.argmax().item()
    return action
</code></pre>
<h4 id="experience-storage">Experience Storage</h4>
<pre><code class="language-python">def remember(self, state: np.ndarray, action: int, reward: float, 
             next_state: np.ndarray, done: bool) -&gt; None:
    &quot;&quot;&quot;Store experience in replay buffer.&quot;&quot;&quot;
    self.memory.append((state, action, reward, next_state, done))
</code></pre>
<h4 id="training-step">Training Step</h4>
<pre><code class="language-python">def replay(self) -&gt; Optional[float]:
    &quot;&quot;&quot;Train the model on a batch of experiences.&quot;&quot;&quot;
    if len(self.memory) &lt; self.batch_size:
        return None

    batch = random.sample(self.memory, self.batch_size)
    states, actions, rewards, next_states, dones = zip(*batch)

    # Convert to tensors
    states = torch.FloatTensor(np.array(states)).to(self.device)
    actions = torch.LongTensor(actions).unsqueeze(1).to(self.device)
    rewards = torch.FloatTensor(rewards).to(self.device)
    next_states = torch.FloatTensor(np.array(next_states)).to(self.device)
    dones = torch.BoolTensor(dones).to(self.device)

    # Compute Q-values
    curr_Q = self.model(states).gather(1, actions).squeeze()
    next_Q = self.target_model(next_states).max(1)[0]
    target_Q = rewards + self.gamma * next_Q * (~dones)

    # Compute loss and update
    loss = self.criterion(curr_Q, target_Q.detach())
    self.optimizer.zero_grad()
    loss.backward()
    self.optimizer.step()

    # Update epsilon
    if self.epsilon &gt; self.eps_min:
        self.epsilon *= self.eps_decay

    self.training_step += 1
    return loss.item()
</code></pre>
<h2 id="training-process">Training Process</h2>
<h3 id="enhanced-training-pipeline">Enhanced Training Pipeline</h3>
<p>The training process (<code>rl_ids/modeling/train.py</code>) includes several advanced features:</p>
<h4 id="1-curriculum-learning">1. Curriculum Learning</h4>
<p>Training progresses through stages of increasing difficulty:</p>
<pre><code class="language-python">if curriculum_learning:
    stage_size = num_episodes // curriculum_stages
    for i in range(curriculum_stages):
        start_ep = i * stage_size
        end_ep = min((i + 1) * stage_size, num_episodes)
        curriculum_episodes.append((start_ep, end_ep, i + 1))
</code></pre>
<h4 id="2-learning-rate-scheduling">2. Learning Rate Scheduling</h4>
<p>Adaptive learning rate adjustment:</p>
<pre><code class="language-python">if lr_scheduler == &quot;cosine&quot;:
    scheduler = torch.optim.lr_scheduler.CosineAnnealingLR(
        agent.optimizer, T_max=num_episodes, eta_min=lr * 0.01
    )
elif lr_scheduler == &quot;step&quot;:
    scheduler = torch.optim.lr_scheduler.StepLR(
        agent.optimizer, step_size=num_episodes // 4, gamma=0.5
    )
</code></pre>
<h4 id="3-early-stopping">3. Early Stopping</h4>
<p>Prevents overfitting with validation-based early stopping:</p>
<pre><code class="language-python">if val_accuracy &gt; best_val_accuracy:
    best_val_accuracy = val_accuracy
    patience_counter = 0
    agent.save_model(best_model_path)
else:
    patience_counter += 1

if patience_counter &gt;= early_stopping_patience:
    logger.info(f&quot;Early stopping triggered at episode {episode}&quot;)
    break
</code></pre>
<h4 id="4-gradient-clipping">4. Gradient Clipping</h4>
<p>Stabilizes training with gradient clipping:</p>
<pre><code class="language-python">if grad_clip &gt; 0:
    torch.nn.utils.clip_grad_norm_(agent.model.parameters(), grad_clip)
</code></pre>
<h3 id="training-metrics">Training Metrics</h3>
<p>The system tracks comprehensive training metrics:</p>
<pre><code class="language-python"># Core metrics
train_rewards = []           # Episode rewards
train_losses = []           # Training losses
train_accuracies = []       # Episode accuracies
val_accuracies = []         # Validation accuracies
learning_rates = []         # Learning rate progression
episode_lengths = []        # Steps per episode

# Advanced metrics
reward_stability = np.std(recent_rewards) / (np.mean(recent_rewards) + 1e-8)
accuracy_stability = np.std(recent_accuracies)
avg_episode_length = np.mean(episode_lengths)
</code></pre>
<h2 id="model-evaluation">Model Evaluation</h2>
<h3 id="evaluation-pipeline">Evaluation Pipeline</h3>
<p>The evaluation script (<code>rl_ids/modeling/evaluate.py</code>) provides comprehensive model assessment:</p>
<h4 id="performance-metrics">Performance Metrics</h4>
<pre><code class="language-python"># Classification metrics
accuracy = accuracy_score(all_true_labels, all_predictions)
precision, recall, f1, _ = precision_recall_fscore_support(
    all_true_labels, all_predictions, average='weighted'
)

# Confusion matrix
cm = confusion_matrix(all_true_labels, all_predictions)

# Classification report
report = classification_report(
    all_true_labels, all_predictions, 
    target_names=class_names, 
    output_dict=True
)
</code></pre>
<h4 id="confidence-analysis">Confidence Analysis</h4>
<pre><code class="language-python"># High confidence predictions
high_conf_mask = np.array(all_confidences) &gt;= confidence_threshold
high_conf_accuracy = accuracy_score(
    np.array(all_true_labels)[high_conf_mask],
    np.array(all_predictions)[high_conf_mask]
)

# Confidence distribution by class
confidence_by_class = {}
for class_idx, class_name in enumerate(class_names):
    class_mask = np.array(all_true_labels) == class_idx
    if np.any(class_mask):
        confidence_by_class[class_name] = np.mean(np.array(all_confidences)[class_mask])
</code></pre>
<h4 id="prediction-timing">Prediction Timing</h4>
<pre><code class="language-python"># Prediction performance
avg_prediction_time = np.mean(prediction_times) * 1000  # Convert to ms
predictions_per_second = 1.0 / np.mean(prediction_times)
</code></pre>
<h2 id="usage-examples">Usage Examples</h2>
<h3 id="basic-agent-training">Basic Agent Training</h3>
<pre><code class="language-python">from rl_ids.agents.dqn_agent import DQNAgent, DQNConfig

# Create configuration
config = DQNConfig(
    state_dim=78,
    action_dim=15,
    lr=1e-4,
    gamma=0.995,
    hidden_dims=[1024, 512, 256, 128]
)

# Initialize agent
agent = DQNAgent(config)

# Training loop
for episode in range(num_episodes):
    state, _ = env.reset()
    done = False

    while not done:
        action = agent.act(state, training=True)
        next_state, reward, done, _, info = env.step(action)

        agent.remember(state, action, reward, next_state, done)

        if len(agent.memory) &gt;= warmup_steps:
            loss = agent.replay()

        state = next_state

    # Update target network periodically
    if episode % target_update_interval == 0:
        agent.update_target()
</code></pre>
<h3 id="model-inference">Model Inference</h3>
<pre><code class="language-python"># Load trained model
agent = DQNAgent(config)
agent.load_model(&quot;models/dqn_model_best.pt&quot;)
agent.epsilon = 0.0  # Disable exploration

# Make predictions
features = extract_features(network_packet)
action = agent.act(features, training=False)
attack_type = class_names[action]
</code></pre>
</article>
                        </div>
                        <div class="hidden text-sm xl:block">
                            <div class="sticky top-20 -mt-6 pt-4">
    <div class="no-scrollbar h-full overflow-auto pb-10">
        <div class="space-y-2">
            <p class="font-medium">On This Page</p>
            <ul class="m-0 list-none">
                
                
                
                
                <li class="mt-0 pt-2">
                    <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                        href="#overview">Overview</a>
                    
                </li>
                
                <li class="mt-0 pt-2">
                    <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                        href="#dqn-agent-architecture">DQN Agent Architecture</a>
                    
                    <ul class="m-0 list-none pl-4">
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#core-components">Core Components</a>
                        </li>
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#network-architecture">Network Architecture</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li class="mt-0 pt-2">
                    <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                        href="#dqn-configuration">DQN Configuration</a>
                    
                    <ul class="m-0 list-none pl-4">
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#configuration-class">Configuration Class</a>
                        </li>
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#training-configuration">Training Configuration</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li class="mt-0 pt-2">
                    <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                        href="#dqn-agent-implementation">DQN Agent Implementation</a>
                    
                    <ul class="m-0 list-none pl-4">
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#agent-class">Agent Class</a>
                        </li>
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#key-methods">Key Methods</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li class="mt-0 pt-2">
                    <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                        href="#training-process">Training Process</a>
                    
                    <ul class="m-0 list-none pl-4">
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#enhanced-training-pipeline">Enhanced Training Pipeline</a>
                        </li>
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#training-metrics">Training Metrics</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li class="mt-0 pt-2">
                    <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                        href="#model-evaluation">Model Evaluation</a>
                    
                    <ul class="m-0 list-none pl-4">
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#evaluation-pipeline">Evaluation Pipeline</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li class="mt-0 pt-2">
                    <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                        href="#usage-examples">Usage Examples</a>
                    
                    <ul class="m-0 list-none pl-4">
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#basic-agent-training">Basic Agent Training</a>
                        </li>
                        
                        <li class="mt-0 pt-2">
                            <a class="inline-block no-underline transition-colors hover:text-foreground text-muted-foreground"
                                href="#model-inference">Model Inference</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                
                
                
            </ul>
        </div>
    </div>
</div>
                        </div>
                    </main>
                </div>
            </div>
            <dialog id="bottom-sidebar" data-closing="0"
    class="backdrop:bg-black backdrop:opacity-80 backdrop:transition-all backdrop:duration-500 text-foreground"
    onclick="onBottomSidebarDialogClick(event)">
    <div
        class="fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background max-h-[60svh] p-0 transition-transform duration-500 ease-[cubic-bezier(0.32,0.72,0,1)]">
        <div class="mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"></div>
        <div class="overflow-auto p-6 space-y-3">
            
            

            <div class="flex flex-col">
                
                
                <a href="../.." class="text-base shrink-0">
    Home
</a>
                
                
            </div>
            

            <div class="flex flex-col">
                
                <div class="flex flex-col space-y-3 pt-4">
                    <h4 class="font-medium">User Guide </h4>
                    
                    <a href="../../user-guide/" class="text-base shrink-0">
    Overview
</a>
                    
                    <a href="../../user-guide/installation/" class="text-base shrink-0">
    Installation
</a>
                    
                    <a href="../../user-guide/network-monitoring/" class="text-base shrink-0">
    Network Monitoring
</a>
                    
                    <a href="../../user-guide/website-monitoring/" class="text-base shrink-0">
    Website Monitoring
</a>
                    
                </div>
                
            </div>
            

            <div class="flex flex-col">
                
                <div class="flex flex-col space-y-3 pt-4">
                    <h4 class="font-medium">API Reference </h4>
                    
                    <a href="../../api/" class="text-base shrink-0">
    Overview
</a>
                    
                    <a href="../../api/python-client/" class="text-base shrink-0">
    Python Client
</a>
                    
                    <a href="../../api/examples/" class="text-base shrink-0">
    Examples
</a>
                    
                </div>
                
            </div>
            

            <div class="flex flex-col">
                
                <div class="flex flex-col space-y-3 pt-4">
                    <h4 class="font-medium">Modules </h4>
                    
                    <a href="../" class="text-base shrink-0">
    Core Components
</a>
                    
                    <a href="./" class="text-base shrink-0">
    RL Agents
</a>
                    
                    <a href="../features/" class="text-base shrink-0">
    Feature Extraction
</a>
                    
                </div>
                
            </div>
            

            <div class="flex flex-col">
                
                <div class="flex flex-col space-y-3 pt-4">
                    <h4 class="font-medium">Development </h4>
                    
                    <a href="../../development/contributing/" class="text-base shrink-0">
    Contributing
</a>
                    
                    <a href="../../development/architecture/" class="text-base shrink-0">
    Architecture
</a>
                    
                    <a href="../../development/testing/" class="text-base shrink-0">
    Testing
</a>
                    
                </div>
                
            </div>
            

            <div class="flex flex-col">
                
                
                <a href="../../faq/" class="text-base shrink-0">
    FAQ
</a>
                
                
            </div>
            

            <div class="flex flex-col">
                
                
                <a href="../../changelog/" class="text-base shrink-0">
    Changelog
</a>
                
                
            </div>
            

            <div class="flex flex-col">
                
                
                <a href="../../license/" class="text-base shrink-0">
    LICENSE
</a>
                
                
            </div>
            
            
        </div>
    </div>
</dialog>
        </div>
    </div> 
    
    <script src="../../search/main.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/iconify-icon@2.3.0/dist/iconify-icon.min.js"></script>
    <script src="../../js/copy-button.js"></script>
</body>

</html>